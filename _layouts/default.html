<!DOCTYPE html>
<html lang="{{ page.lang | default: site.lang | default: "en-US" }}">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="{{ "/assets/css/main.css?v=" | append: site.github.build_revision | relative_url }}">
  </head>
  <body>
    <div class="container-lg">
      <div class="hero-banner">
        {% if site.title and site.title != page.title %}
        <h1><a href="{{ "/" | absolute_url }}">{{ site.title }}</a></h1>
        {% endif %}

        <p>Subscribe to the calendar or download the .ics file</p>
        <ul>
          <li>
            <a href="all.ics" class="download-link">üíæ Download Calendar File</a>
          </li>
          <li>
            <div class="url-copy-box">
              <input type="text" class="url-input" value="{{ "/" | absolute_url }}/all.ics" readonly id="calendarUrl">
              <button class="copy-btn" onclick="copyUrl()">üìã Copy URL</button>
            </div>
          </li>
        </ul>
      </div>
    </div>

    <div class="container-lg px-3">
      <div class="accordion">
        <div class="accordion-header" onclick="toggleAccordion()">
          <h2>üì± How to subscribe to this calendar</h2>
          <span class="accordion-icon">‚ñº</span>
        </div>
        <div class="accordion-content" id="accordionContent">
          <div class="accordion-inner">
            <p>By subscribing to the calendar using the URL above, you'll automatically receive updates when new races are added or changed. Here's how to do it on different platforms:</p>
            
            <h3><span class="platform-icon">üçé</span>macOS & iOS (iPhone/iPad)</h3>
            <ol>
              <li>Copy the calendar URL by clicking the "Copy URL" button above</li>
              <li>Open the <strong>Calendar</strong> app</li>
              <ul>
                <li>On macOS: Go to <strong>File ‚Üí New Calendar Subscription</strong></li>
                <li>On iOS: Tap <strong>Calendars ‚Üí Add Calendar ‚Üí Add Subscription Calendar</strong></li>
              </ul>
              <li>Paste the URL and click <strong>Subscribe</strong></li>
              <li>Choose your preferred update frequency and click <strong>OK</strong></li>
            </ol>
            
            <h3><span class="platform-icon">ü§ñ</span>Android (Google Calendar)</h3>
            <ol>
              <li>Copy the calendar URL by clicking the "Copy URL" button above</li>
              <li>Open a web browser and go to <a href="https://calendar.google.com" target="_blank">calendar.google.com</a></li>
              <li>On the left sidebar, click the <strong>+</strong> next to "Other calendars"</li>
              <li>Select <strong>"From URL"</strong></li>
              <li>Paste the calendar URL and click <strong>Add calendar</strong></li>
              <li>The calendar will sync to your Google Calendar app on Android</li>
            </ol>
            
            <h3><span class="platform-icon">ü™ü</span>Windows (Outlook)</h3>
            <ol>
              <li>Copy the calendar URL by clicking the "Copy URL" button above</li>
              <li>Open <strong>Outlook</strong> and go to Calendar view</li>
              <li>Click <strong>Add Calendar ‚Üí From Internet</strong></li>
              <li>Paste the URL into the text box</li>
              <li>Click <strong>OK</strong> to subscribe</li>
              <li>The calendar will appear in your calendar list</li>
            </ol>
            
            <div class="tip-box">
              <strong>üí° Subscription vs. Download:</strong> When you <em>subscribe</em> using the URL, your calendar app will automatically check for updates periodically. If you just <em>download</em> the .ics file, you'll need to manually re-import it to see any changes or new races.
            </div>
          </div>
        </div>
      </div>

      {{ content }}
    </div>

    <script>
      function toggleAccordion() {
        const content = document.getElementById('accordionContent');
        const icon = document.querySelector('.accordion-icon');
        content.classList.toggle('open');
        icon.classList.toggle('open');
      }

      function copyUrl() {
        const urlInput = document.getElementById('calendarUrl');
        const copyBtn = document.querySelector('.copy-btn');
        
        urlInput.select();
        urlInput.setSelectionRange(0, 99999); // For mobile devices
        
        navigator.clipboard.writeText(urlInput.value).then(() => {
          copyBtn.textContent = '‚úì Copied!';
          copyBtn.classList.add('copied');
          
          setTimeout(() => {
            copyBtn.textContent = 'üìã Copy URL';
            copyBtn.classList.remove('copied');
          }, 2000);
        });
      }
    </script>

  </body>
</html>
